<!DOCTYPE html>
<html lang="id">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gempa Bumi - SeismoTech</title>
    <link rel="stylesheet" href="/CSS/dashboard.css">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <style>
        /* Tambahan gaya untuk peta BMKG */
        .peta-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            background: #f8f9fa;
            padding: 2rem;
            border-radius: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
            max-width: 900px;
            margin: 2rem auto;
        }

        .peta-container img {
            width: 100%;
            height: auto;
            border-radius: 10px;
            object-fit: contain;
            transition: transform 0.4s ease, box-shadow 0.4s ease;
        }

        .peta-container img:hover {
            transform: scale(1.02);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
        }

        .peta-caption {
            text-align: center;
            margin-top: 1rem;
            font-size: 0.95rem;
            color: #555;
            font-style: italic;
        }

        @media (max-width: 768px) {
            .peta-container {
                padding: 1rem;
                border-radius: 10px;
            }
        }
    </style>
</head>

<body>
    <!-- Header & Hero Section Combined -->
    <section class="hero-section">
        <!-- Navigation -->
        <header class="navbar">
            <div class="nav-container">
                <div class="logo">SeismoTech</div>
                <nav class="nav-menu">
                    <a href="#beranda" class="nav-link">Beranda</a>
                    <a href="#gempa" class="nav-link">Gempa</a>
                    <a href="#dampak" class="nav-link">Dampak</a>
                    <a href="#pencegahan" class="nav-link">Pencegahan</a>
                    <a href="#informasi" class="nav-link">Informasi</a>
                </nav>
            </div>
        </header>

        <!-- Hero Content -->
        <div class="hero-content">
            <div>
                <h1>Gempa Bumi</h1>
                <p>Gempa bumi merupakan gejala alam yang ditimbulkan oleh tiba-tiba bergeraknya lempeng tektonik di
                    dalam bumi. Gempa bumi dapat terjadi karena adanya pergerakan magma di dalam bumi, namun penyebab
                    utama adalah kegiatan pergerakan lempeng tektonik bumi yang terus bergerak di atas mantel bumi yang
                    panas.</p>
            </div>
        </div>

        <div class="hero-overlay"></div>
    </section>

    <!-- Jenis-Jenis Gempa Section -->
    <section id="jenis-gempa" class="jenis-gempa-section">
        <h2>Jenis-Jenis Gempa</h2>
        <div class="gempa-cards">
            <div class="card">
                <div class="card-image tektonik">
                    <img src="/assets/gempa/tektonik.png" alt="">
                    <h3>Gempa Tektonik</h3>
                </div>
            </div>
            <div class="card">
                <a href="/JenisGempa/vulkanik.html">
                    <div class="card-image vulkanik">
                        <img src="/assets/gempa/vulkanik.png" alt="">
                        <h3>Gempa Vulkanik</h3>
                    </div>
                </a>
            </div>
            <div class="card">
                <div class="card-image buatan">
                    <img src="/assets/gempa/buatan.png" alt="">
                    <h3>Gempa Buatan</h3>
                </div>
            </div>
        </div>
    </section>

    <!-- Dampak Section -->
    <section id="dampak" class="dampak-section">
        <h2>Dampak</h2>
        <div class="dampak-container">
            <div class="dampak-item dampak-positif">
                <div class="dampak-image positif">
                    <img src="/assets/dampak/dampakPositive.jpg" alt="">
                </div>
                <div class="dampak-content">
                    <h3>Dampak Positif</h3>
                    <p>Munculnya sumber daya alam baru seperti mata air dan mineral. mendorong inovasi teknologi
                        mitigasi bencana, terbentuknya daratan atau pulau baru, dan menambah pengetahuan ilmiah</p>
                </div>
            </div>

            <div class="dampak-divider"></div>

            <div class="dampak-item dampak-negatif">
                <div class="dampak-content">
                    <h3>Dampak Negatif</h3>
                    <p>Menimbulkan kerusakan infrastruktur, kehilangan nyawa, dan gangguan sosial ekonomi di wilayah
                        terdampak. Gempa besar juga dapat memicu tsunami di daerah pesisir.</p>
                </div>
                <div class="dampak-image negatif">
                    <img src="/assets/dampak/dampakNegative.jpg" alt="">
                </div>
            </div>
        </div>
    </section>

    <!-- Perencanaan Tindakan Bencana -->
    <section id="pencegahan" class="pencegahan-section">
        <h2>Perencanaan Tindakan Bencana Gempa Bumi</h2>
        <p>Kita dapat mempersiapkan diri dengan perencanaan, pelatihan evakuasi, dan penguatan bangunan tahan gempa.</p>
        <button class="btn-perencanaan">Selengkapnya ></button>
    </section>

    <!-- Informasi Gempa Real-Time -->
    <section id="informasi" class="informasi-section">
        <div class="info-header">
            <h2>Informasi Gempa Bumi Real-Time</h2>
            <div class="refresh-info">
                <button class="btn-refresh" onclick="loadGempaData()">
                    <span class="refresh-icon">↻</span> Refresh
                </button>
                <span class="last-update" id="last-update">Terakhir diperbarui: -</span>
            </div>
        </div>

        <div class="peta-container">
            <div class="peta-loading" id="peta-loading">
                <div class="loading-spinner"></div>
                <p>Memuat peta gempa...</p>
            </div>
            <img id="peta-img" src="/assets/perencanaa.png" alt="Peta Gempa Indonesia" style="display: none;">
            <div class="peta-caption" id="peta-caption">Data gempa terkini akan muncul di sini.</div>
        </div>
    </section>

    <!-- Tabel Beberapa Gempa -->
    <section class="tabel-gempa-section">
        <h2>Beberapa Gempa Bumi Real-Time</h2>
        <div class="tabel-wrapper">
            <div id="tabel-status" class="tabel-loading">
                <div class="loading-spinner"></div>
                <p>Memuat data gempa...</p>
            </div>
            <table class="tabel-gempa" id="tabel-gempa" style="display: none;">
                <thead>
                    <tr>
                        <th>#</th>
                        <th>Waktu</th>
                        <th>Lokasi</th>
                        <th>Magnitudo</th>
                        <th>Kedalaman</th>
                        <th>Koordinat</th>
                        <th>Wilayah</th>
                    </tr>
                </thead>
                <tbody id="tabel-body"></tbody>
            </table>
        </div>
    </section>

    <!-- Dibalik Layar Section -->
    <section class="dibalik-layar-section">
        <h2>Dibalik Layar</h2>
        <div class="dibalik-container">
            <div class="dibalik-item">
                <div class="dibalik-label">Tectik</div>
            </div>
            <div class="dibalik-item">
                <div class="dibalik-label">Kime</div>
            </div>
            <div class="dibalik-item">
                <div class="dibalik-label">Alimito</div>
            </div>
            <div class="dibalik-item">
                <div class="dibalik-label">Togo</div>
            </div>
            <div class="dibalik-item">
                <div class="dibalik-label">Argel</div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="kata-kata">
            <p>"Sensing The Earth, Securing The Future"</p>
        </div>
        <div class="copyright">
            <p>Copyright 2025. All rights Reserved</p>
        </div>
    </footer>

    <script>
        function updateLastRefreshTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('id-ID', { hour: '2-digit', minute: '2-digit', second: '2-digit' });
            document.getElementById('last-update').textContent = `Terakhir diperbarui: ${timeString}`;
        }

        async function loadGempaData() {
            const timestamp = new Date().getTime();
            const tabelStatus = document.getElementById('tabel-status');
            const petaImg = document.getElementById('peta-img');
            const petaLoading = document.getElementById('peta-loading');
            const petaCaption = document.getElementById('peta-caption');
            const tabelGempa = document.getElementById('tabel-gempa');
            const tbody = document.getElementById('tabel-body');

            try {
                const [resTerkini, resTerbaru] = await Promise.all([
                    fetch(`https://data.bmkg.go.id/DataMKG/TEWS/autogempa.json?t=${timestamp}`, { cache: 'no-store' }),
                    fetch(`https://data.bmkg.go.id/DataMKG/TEWS/gempaterkini.json?t=${timestamp}`, { cache: 'no-store' })
                ]);

                if (!resTerkini.ok || !resTerbaru.ok) throw new Error('Gagal memuat data BMKG');

                const dataTerkini = await resTerkini.json();
                const dataTerbaru = await resTerbaru.json();
                const gempaTerkini = dataTerkini.Infogempa?.gempa || null;

                if (gempaTerkini?.Shakemap) {
                    const imageUrl = `https://data.bmkg.go.id/DataMKG/TEWS/${gempaTerkini.Shakemap}?t=${timestamp}`;
                    petaImg.src = imageUrl;
                    petaImg.style.display = 'block';
                    petaLoading.style.display = 'none';
                    petaCaption.textContent = `${gempaTerkini.Wilayah || '-'} | Magnitudo: ${gempaTerkini.Magnitude} | Kedalaman: ${gempaTerkini.Kedalaman}`;
                }

                let gempaList = [];
                if (gempaTerkini) gempaList.push(gempaTerkini);
                const daftarGempa = Array.isArray(dataTerbaru.Infogempa?.gempa)
                    ? dataTerbaru.Infogempa.gempa
                    : [dataTerbaru.Infogempa?.gempa];
                gempaList.push(...daftarGempa.slice(0, 9));

                tbody.innerHTML = '';
                gempaList.slice(0, 10).forEach((gempa, index) => {
                    const magnitudo = parseFloat(gempa.Magnitude) || 0;
                    let magClass = 'magnitudo-low';
                    if (magnitudo >= 6) magClass = 'magnitudo-high';
                    else if (magnitudo >= 5) magClass = 'magnitudo-medium';

                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${gempa.Tanggal || '-'} ${gempa.Jam || '-'}</td>
                        <td>${gempa.Wilayah || '-'}</td>
                        <td><span class="magnitudo-badge ${magClass}">${magnitudo}</span></td>
                        <td>${gempa.Kedalaman || '-'}</td>
                        <td>${gempa.Lintang || '-'}, ${gempa.Bujur || '-'}</td>
                        <td>${gempa.Wilayah || '-'}</td>
                    `;
                    tbody.appendChild(row);
                });

                tabelGempa.style.display = 'table';
                tabelStatus.style.display = 'none';
                updateLastRefreshTime();

            } catch (err) {
                console.error('Kesalahan API:', err);
                tabelStatus.innerHTML = '<p>⚠️ Tidak dapat memuat data gempa terkini.</p>';
                petaLoading.innerHTML = '<p>Gagal memuat peta, menampilkan cadangan...</p>';
                petaImg.style.display = 'block';
            }
        }

        async function startRealtime() {
            await loadGempaData();
            setTimeout(startRealtime, 60000);
        }

        document.addEventListener('DOMContentLoaded', startRealtime);
    </script>

    <script>
        // Efek aktif saat diklik
        const navLinks = document.querySelectorAll('.nav-link');

        navLinks.forEach(link => {
            link.addEventListener('click', function () {
                navLinks.forEach(l => l.classList.remove('active'));
                this.classList.add('active');
            });
        });

        // Tandai link aktif saat user scroll manual
        window.addEventListener('scroll', () => {
            const scrollY = window.scrollY + 100; // sedikit offset
            navLinks.forEach(link => {
                const section = document.querySelector(link.getAttribute('href'));
                if (
                    section.offsetTop <= scrollY &&
                    section.offsetTop + section.offsetHeight > scrollY
                ) {
                    navLinks.forEach(l => l.classList.remove('active'));
                    link.classList.add('active');
                }
            });
        });
    </script>

</body>

</html>